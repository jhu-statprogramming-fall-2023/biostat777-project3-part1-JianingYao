<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="HMMpanelFE generates a sample from the posterior distribution of
the fixed-effects model with varying individual effects model
discussed in Park (2011).  The code works for both balanced and
unbalanced panel data as long as there is no missing data in the
middle of each group.  This model uses a multivariate Normal prior
for the fixed effects parameters and varying individual effects, an
Inverse-Gamma prior on the residual error variance, and Beta prior
for transition probabilities. The user supplies data and priors,
and a sample from the posterior distribution is returned as an mcmc
object, which can be subsequently analyzed with functions provided
in the coda package."><title>Markov Chain Monte Carlo for the Hidden Markov Fixed-effects Model — HMMpanelFE • MCMCpack</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Mono-0.4.8/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Markov Chain Monte Carlo for the Hidden Markov Fixed-effects Model — HMMpanelFE"><meta property="og:description" content="HMMpanelFE generates a sample from the posterior distribution of
the fixed-effects model with varying individual effects model
discussed in Park (2011).  The code works for both balanced and
unbalanced panel data as long as there is no missing data in the
middle of each group.  This model uses a multivariate Normal prior
for the fixed effects parameters and varying individual effects, an
Inverse-Gamma prior on the residual error variance, and Beta prior
for transition probabilities. The user supplies data and priors,
and a sample from the posterior distribution is returned as an mcmc
object, which can be subsequently analyzed with functions provided
in the coda package."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MCMCpack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6-3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Demonstration.html">Demonstration</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/JNinnnngg" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Markov Chain Monte Carlo for the Hidden Markov Fixed-effects Model</h1>
      
      <div class="d-none name"><code>HMMpanelFE.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>HMMpanelFE generates a sample from the posterior distribution of
the fixed-effects model with varying individual effects model
discussed in Park (2011).  The code works for both balanced and
unbalanced panel data as long as there is no missing data in the
middle of each group.  This model uses a multivariate Normal prior
for the fixed effects parameters and varying individual effects, an
Inverse-Gamma prior on the residual error variance, and Beta prior
for transition probabilities. The user supplies data and priors,
and a sample from the posterior distribution is returned as an mcmc
object, which can be subsequently analyzed with functions provided
in the coda package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">HMMpanelFE</span><span class="op">(</span></span>
<span>  <span class="va">subject.id</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">m</span>,</span>
<span>  mcmc <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  burnin <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  b0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  B0 <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  c0 <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  d0 <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  delta0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  Delta0 <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  a <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  b <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>subject.id</dt>
<dd><p>A numeric vector indicating the group number. It
should start from 1.</p></dd>


<dt>y</dt>
<dd><p>The response variable.</p></dd>


<dt>X</dt>
<dd><p>The model matrix excluding the constant.</p></dd>


<dt>m</dt>
<dd><p>A vector of break numbers for each subject in the panel.</p></dd>


<dt>mcmc</dt>
<dd><p>The number of MCMC iterations after burn-in.</p></dd>


<dt>burnin</dt>
<dd><p>The number of burn-in iterations for the sampler.</p></dd>


<dt>thin</dt>
<dd><p>The thinning interval used in the simulation.  The
number of MCMC iterations must be divisible by this value.</p></dd>


<dt>verbose</dt>
<dd><p>A switch which determines whether or not the
progress of the sampler is printed to the screen.  If
<code>verbose</code> is greater than 0, the iteration number and the
posterior density samples are printed to the screen every
<code>verbose</code>th iteration.</p></dd>


<dt>b0</dt>
<dd><p>The prior mean of \(\beta\).  This can either be a
scalar or a column vector with dimension equal to the number of
betas. If this takes a scalar value, then that value will serve
as the prior mean for all of the betas.</p></dd>


<dt>B0</dt>
<dd><p>The prior precision of \(\beta\).  This can either be a
scalar or a square matrix with dimensions equal to the number of
betas.  If this takes a scalar value, then that value times an
identity matrix serves as the prior precision of beta. Default
value of 0 is equivalent to an improper uniform prior for beta.</p></dd>


<dt>c0</dt>
<dd><p>\(c_0/2\) is the shape parameter for the inverse Gamma
prior on \(\sigma^2\) (the variance of the disturbances). The
amount of information in the inverse Gamma prior is something
like that from \(c_0\) pseudo-observations.</p></dd>


<dt>d0</dt>
<dd><p>\(d_0/2\) is the scale parameter for the inverse Gamma
prior on \(\sigma^2\) (the variance of the disturbances). In
constructing the inverse Gamma prior, \(d_0\) acts like the sum
of squared errors from the \(c_0\) pseudo-observations.</p></dd>


<dt>delta0</dt>
<dd><p>The prior mean of \(\alpha\).</p></dd>


<dt>Delta0</dt>
<dd><p>The prior precision of \(\alpha\).</p></dd>


<dt>a</dt>
<dd><p>\(a\) is the shape1 beta prior for transition
probabilities.  By default, the expected duration is computed and
corresponding a and b values are assigned. The expected duration
is the sample period divided by the number of states.</p></dd>


<dt>b</dt>
<dd><p>\(b\) is the shape2 beta prior for transition
probabilities.  By default, the expected duration is computed and
corresponding a and b values are assigned. The expected duration
is the sample period divided by the number of states.</p></dd>


<dt>seed</dt>
<dd><p>The seed for the random number generator.  If NA,
current R system seed is used.</p></dd>


<dt>...</dt>
<dd><p>further arguments to be passed</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An mcmc object that contains the posterior sample. This
  object can be summarized by functions provided by the coda
  package.  The object contains an attribute <code>sigma</code> storage
  matrix that contains time-varying residual variance, an attribute</p>
<p></p>
<p><code>state</code> storage matrix that contains posterior samples of
  hidden states, and an attribute <code>delta</code> storage matrix
  containing time-varying intercepts.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>HMMpanelFE</code> simulates from the fixed-effect hidden Markov
pbject level: $$\varepsilon_{it} \sim \mathcal{N}(\alpha_{im},
\sigma^2_{im})$$</p>
<p>We assume standard, semi-conjugate priors: $$\beta \sim
\mathcal{N}(b_0,B_0^{-1})$$ And: $$\sigma^{-2} \sim
\mathcal{G}amma(c_0/2, d_0/2)$$ And: $$\alpha \sim
\mathcal{N}(delta_0,Delta_0^{-1})$$ \(\beta\), \(\alpha\) and
\(\sigma^{-2}\) are assumed <em>a priori</em> independent.</p>
<p>And: $$p_{mm} \sim \mathcal{B}eta(a, b),\;\; m = 1, \ldots, M$$
Where \(M\) is the number of states.</p>
<p>OLS estimates are used for starting values.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jong Hee Park, 2012. ``Unified Method for Dynamic and
  Cross-Sectional Heterogeneity: Introducing Hidden Markov Panel
  Models.''  <em>American Journal of Political Science</em>.56:
  1040-1054. &lt;doi: 10.1111/j.1540-5907.2012.00590.x&gt;</p>
<p>Siddhartha Chib. 1998. ``Estimation and comparison of multiple
  change-point models.'' <em>Journal of Econometrics</em>. 86: 221-241.
  &lt;doi: 10.1016/S0304-4076(97)00115-2&gt;</p>
<p>Andrew D. Martin, Kevin M. Quinn, and Jong Hee Park. 2011.
  ``MCMCpack: Markov Chain Monte Carlo in R.'', <em>Journal of Statistical
  Software</em>. 42(9): 1-21.  <a href="https://doi.org/10.18637/jss.v042.i09" class="external-link">doi:10.18637/jss.v042.i09</a>
.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co">## data generating</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1974</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">30</span></span></span>
<span class="r-in"><span>  <span class="cn">T</span> <span class="op">&lt;-</span> <span class="fl">80</span></span></span>
<span class="r-in"><span>  <span class="va">NT</span> <span class="op">&lt;-</span> <span class="va">N</span><span class="op">*</span><span class="cn">T</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## true parameter values</span></span></span>
<span class="r-in"><span>  <span class="va">true.beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">true.sigma</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span>  <span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">NT</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">NT</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## group-specific breaks</span></span></span>
<span class="r-in"><span>  <span class="va">break.point</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">T</span><span class="op">/</span><span class="fl">2</span>, <span class="va">N</span><span class="op">)</span>; <span class="va">break.sigma</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">N</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>  <span class="va">break.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span>, <span class="va">NT</span>, <span class="op">)</span>;</span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">NT</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">id</span>  <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>, each<span class="op">=</span><span class="va">NT</span><span class="op">/</span><span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">K</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>;</span></span>
<span class="r-in"><span>  <span class="va">true.beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">true.beta</span>, <span class="va">K</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## compute the break probability</span></span></span>
<span class="r-in"><span>  <span class="va">ruler</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">W.mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">T</span>, <span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">W.mat</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">ruler</span><span class="op">-</span><span class="va">break.point</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">break.sigma</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="va">Weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">W.mat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## draw time-varying individual effects and sample y</span></span></span>
<span class="r-in"><span>  <span class="va">j</span> <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="va">true.sigma.alpha</span> <span class="op">&lt;-</span> <span class="fl">30</span></span></span>
<span class="r-in"><span>  <span class="va">true.alpha1</span> <span class="op">&lt;-</span> <span class="va">true.alpha2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">Xi</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">j</span><span class="op">:</span><span class="op">(</span><span class="va">j</span><span class="op">+</span><span class="cn">T</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">true.mean</span> <span class="op">&lt;-</span> <span class="va">Xi</span>  <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">true.beta</span></span></span>
<span class="r-in"><span>    <span class="va">weight</span> <span class="op">&lt;-</span> <span class="va">Weight</span><span class="op">[</span><span class="va">j</span><span class="op">:</span><span class="op">(</span><span class="va">j</span><span class="op">+</span><span class="cn">T</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">true.alpha1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="va">true.sigma.alpha</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">true.alpha2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">true.alpha1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="va">y</span><span class="op">[</span><span class="va">j</span><span class="op">:</span><span class="op">(</span><span class="va">j</span><span class="op">+</span><span class="cn">T</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">weight</span><span class="op">)</span><span class="op">*</span><span class="va">true.mean</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">weight</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="cn">T</span>, <span class="fl">0</span>, <span class="va">true.sigma</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>            <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">weight</span><span class="op">)</span><span class="op">*</span><span class="va">true.alpha1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>            <span class="op">(</span><span class="va">weight</span><span class="op">*</span><span class="va">true.mean</span> <span class="op">+</span> <span class="va">weight</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="cn">T</span>, <span class="fl">0</span>, <span class="va">true.sigma</span><span class="op">)</span> <span class="op">+</span> <span class="va">weight</span><span class="op">*</span><span class="va">true.alpha2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">j</span> <span class="op">&lt;-</span> <span class="va">j</span> <span class="op">+</span> <span class="cn">T</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## extract the standardized residuals from the OLS with fixed-effects</span></span></span>
<span class="r-in"><span>  <span class="va">FEols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">-</span><span class="fl">1</span> <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">resid.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">rstandard</a></span><span class="op">(</span><span class="va">FEols</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">time.id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">80</span>, <span class="va">N</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## model fitting</span></span></span>
<span class="r-in"><span>  <span class="va">G</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>  <span class="va">BF</span> <span class="op">&lt;-</span> <span class="fu"><a href="testpanelSubjectBreak.html">testpanelSubjectBreak</a></span><span class="op">(</span>subject.id<span class="op">=</span><span class="va">id</span>, time.id<span class="op">=</span><span class="va">time.id</span>,</span></span>
<span class="r-in"><span>         resid<span class="op">=</span> <span class="va">resid.all</span>, max.break<span class="op">=</span><span class="fl">3</span>, minimum <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>         mcmc<span class="op">=</span><span class="va">G</span>, burnin <span class="op">=</span> <span class="va">G</span>, thin<span class="op">=</span><span class="fl">1</span>, verbose<span class="op">=</span><span class="va">G</span>,</span></span>
<span class="r-in"><span>         b0<span class="op">=</span><span class="fl">0</span>, B0<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">100</span>, c0<span class="op">=</span><span class="fl">2</span>, d0<span class="op">=</span><span class="fl">2</span>, Time <span class="op">=</span> <span class="va">time.id</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## get the estimated break numbers</span></span></span>
<span class="r-in"><span>  <span class="va">estimated.breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="make.breaklist.html">make.breaklist</a></span><span class="op">(</span><span class="va">BF</span>, threshold<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## model fitting</span></span></span>
<span class="r-in"><span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">HMMpanelFE</span><span class="op">(</span>subject.id <span class="op">=</span> <span class="va">id</span>, <span class="va">y</span>, X<span class="op">=</span><span class="va">X</span>, m <span class="op">=</span>  <span class="va">estimated.breaks</span>,</span></span>
<span class="r-in"><span>             mcmc<span class="op">=</span><span class="va">G</span>, burnin<span class="op">=</span><span class="va">G</span>, thin<span class="op">=</span><span class="fl">1</span>, verbose<span class="op">=</span><span class="va">G</span>,</span></span>
<span class="r-in"><span>             b0<span class="op">=</span><span class="fl">0</span>, B0<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">100</span>, c0<span class="op">=</span><span class="fl">2</span>, d0<span class="op">=</span><span class="fl">2</span>, delta0<span class="op">=</span><span class="fl">0</span>, Delta0<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## print out the slope estimate</span></span></span>
<span class="r-in"><span>  <span class="co">## true values are 1 and 1</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## compare them with the result from the constant fixed-effects</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">FEols</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Website designed by Jianing Yao</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

