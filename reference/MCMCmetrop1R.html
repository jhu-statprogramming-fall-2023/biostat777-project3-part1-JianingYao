<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function allows a user to construct a sample from a user-defined
continuous distribution using a random walk Metropolis algorithm."><title>Metropolis Sampling from User-Written R function — MCMCmetrop1R • MCMCpack</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Mono-0.4.7/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Metropolis Sampling from User-Written R function — MCMCmetrop1R"><meta property="og:description" content="This function allows a user to construct a sample from a user-defined
continuous distribution using a random walk Metropolis algorithm."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MCMCpack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6-3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Demonstration.html">Demonstration</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/JNinnnngg" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Metropolis Sampling from User-Written R function</h1>
      
      <div class="d-none name"><code>MCMCmetrop1R.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function allows a user to construct a sample from a user-defined
continuous distribution using a random walk Metropolis algorithm.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MCMCmetrop1R</span><span class="op">(</span></span>
<span>  <span class="va">fun</span>,</span>
<span>  <span class="va">theta.init</span>,</span>
<span>  burnin <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  mcmc <span class="op">=</span> <span class="fl">20000</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  tune <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  logfun <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  force.samp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  V <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  optim.method <span class="op">=</span> <span class="st">"BFGS"</span>,</span>
<span>  optim.lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  optim.upper <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  optim.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fnscale <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, trace <span class="op">=</span> <span class="fl">0</span>, REPORT <span class="op">=</span> <span class="fl">10</span>, maxit <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>fun</dt>
<dd><p>The unnormalized (log)density of the distribution from which to
take a sample. This must be a function defined in R whose first argument is
a continuous (possibly vector) variable. This first argument is the point in
the state space at which the (log)density is to be evaluated. Additional
arguments can be passed to <code>fun()</code> by inserting them in the call to
<code>MCMCmetrop1R()</code>. See the Details section and the examples below for
more information.</p></dd>


<dt>theta.init</dt>
<dd><p>Starting values for the sampling. Must be of the
appropriate dimension. It must also be the case that <code>fun(theta.init,
...)</code> is greater than <code>-Inf</code> if <code>fun()</code> is a logdensity or greater
than 0 if <code>fun()</code> is a density.</p></dd>


<dt>burnin</dt>
<dd><p>The number of burn-in iterations for the sampler.</p></dd>


<dt>mcmc</dt>
<dd><p>The number of MCMC iterations after burnin.</p></dd>


<dt>thin</dt>
<dd><p>The thinning interval used in the simulation.  The number of
MCMC iterations must be divisible by this value.</p></dd>


<dt>tune</dt>
<dd><p>The tuning parameter for the Metropolis sampling.  Can be either
a positive scalar or a \(k\)-vector, where \(k\) is the length of
\(\theta\).</p></dd>


<dt>verbose</dt>
<dd><p>A switch which determines whether or not the progress of the
sampler is printed to the screen.  If <code>verbose</code> is greater than 0 the
iteration number, the \(\theta\) vector, the function value, and
the Metropolis acceptance rate are sent to the screen every <code>verbose</code>th
iteration.</p></dd>


<dt>seed</dt>
<dd><p>The seed for the random number generator.  If NA, the Mersenne
Twister generator is used with default seed 12345; if an integer is passed
it is used to seed the Mersenne twister.  The user can also pass a list of
length two to use the L'Ecuyer random number generator, which is suitable
for parallel computation.  The first element of the list is the L'Ecuyer
seed, which is a vector of length six or NA (if NA a default seed of
<code>rep(12345,6)</code> is used).  The second element of list is a positive
substream number. See the MCMCpack specification for more details.</p></dd>


<dt>logfun</dt>
<dd><p>Logical indicating whether <code>fun</code> returns the natural log
of a density function (TRUE) or a density (FALSE).</p></dd>


<dt>force.samp</dt>
<dd><p>Logical indicating whether the sampling should proceed if
the Hessian calculated from the initial call to <code>optim</code> routine to
maximize the (log)density is not negative definite. If
<code>force.samp==TRUE</code> and the Hessian from <code>optim</code> is non-negative
definite, the Hessian is rescaled by subtracting small values from it's main
diagonal until it is negative definite. Sampling proceeds using this
rescaled Hessian in place of the original Hessian from <code>optim</code>. By
default, if <code>force.samp==FALSE</code> and the Hessian from <code>optim</code> is
non-negative definite, an error message is printed and the call to
<code>MCMCmetrop1R</code> is terminated.</p>
<p><em>Please note that a non-negative Hessian at the mode is often an
indication that the function of interest is not a proper density. Thus,
<code>force.samp</code> should only be set equal to <code>TRUE</code> with great
caution.</em></p></dd>


<dt>V</dt>
<dd><p>The variance-covariance matrix for the Gaussian proposal
distribution. Must be a square matrix or <code>NULL</code>. If a square matrix,
<code>V</code> must have dimension equal to the length of <code>theta.init</code>. If
<code>NULL</code>, <code>V</code> is calculated from <code>tune</code> and an initial call to
<code>optim</code>. See the Details section below for more information. Unless the
log-posterior is expensive to compute it will typically be best to use the
default <code>V = NULL</code>.</p></dd>


<dt>optim.method</dt>
<dd><p>The value of the <code>method</code> parameter sent to
<code>optim</code> during an initial maximization of <code>fun</code>. See <code>optim</code>
for more details.</p></dd>


<dt>optim.lower</dt>
<dd><p>The value of the <code>lower</code> parameter sent to
<code>optim</code> during an initial maximization of <code>fun</code>. See <code>optim</code>
for more details.</p></dd>


<dt>optim.upper</dt>
<dd><p>The value of the <code>upper</code> parameter sent to
<code>optim</code> during an initial maximization of <code>fun</code>. See <code>optim</code>
for more details.</p></dd>


<dt>optim.control</dt>
<dd><p>The value of the <code>control</code> parameter sent to
<code>optim</code> during an initial maximization of <code>fun</code>. See <code>optim</code>
for more details.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An mcmc object that contains the posterior sample.  This object can
be summarized by functions provided by the coda package.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>MCMCmetrop1R produces a sample from a user-defined distribution using a
random walk Metropolis algorithm with multivariate normal proposal
distribution. See Gelman et al. (2003) and Robert &amp; Casella (2004) for
details of the random walk Metropolis algorithm.</p>
<p>The proposal distribution is centered at the current value of
\(\theta\) and has variance-covariance \(V\). If \(V\) is
specified by the user to be <code>NULL</code> then \(V\) is calculated
as: \(V = T (-1\cdot H)^{-1} T \), where \(T\) is a the
diagonal positive definite matrix formed from the <code>tune</code> and
\(H\) is the approximate Hessian of <code>fun</code> evaluated at its
mode. This last calculation is done via an initial call to
<code>optim</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Siddhartha Chib; Edward Greenberg. 1995. ``Understanding the
Metropolis-Hastings Algorithm."  <em>The American Statistician</em>, 49,
327-335.</p>
<p>Andrew Gelman, John B. Carlin, Hal S. Stern, and Donald B. Rubin. 2003.
<em>Bayesian Data Analysis</em>. 2nd Edition. Boca Raton: Chapman &amp; Hall/CRC.</p>
<p>Andrew D. Martin, Kevin M. Quinn, and Jong Hee Park. 2011.  ``MCMCpack:
Markov Chain Monte Carlo in R.'', <em>Journal of Statistical Software</em>.
42(9): 1-21.  <a href="https://doi.org/10.18637/jss.v042.i09" class="external-link">doi:10.18637/jss.v042.i09</a>
.</p>
<p>Daniel Pemstein, Kevin M. Quinn, and Andrew D. Martin.  2007.  <em>Scythe
Statistical Library 1.0.</em> <a href="http://scythe.lsa.umich.edu" class="external-link">http://scythe.lsa.umich.edu</a>.</p>
<p>Martyn Plummer, Nicky Best, Kate Cowles, and Karen Vines. 2006.  ``Output
Analysis and Diagnostics for MCMC (CODA)'', <em>R News</em>. 6(1): 7-11.
<a href="https://CRAN.R-project.org/doc/Rnews/Rnews_2006-1.pdf" class="external-link">https://CRAN.R-project.org/doc/Rnews/Rnews_2006-1.pdf</a>.</p>
<p>Christian P. Robert and George Casella. 2004. <em>Monte Carlo Statistical
Methods</em>. 2nd Edition. New York: Springer.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/coda/man/plot.mcmc.html" class="external-link">plot.mcmc</a></code>, <code><a href="https://rdrr.io/pkg/coda/man/summary.mcmc.html" class="external-link">summary.mcmc</a></code>,
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>, <code><a href="https://rdrr.io/pkg/mcmc/man/metrop.html" class="external-link">metrop</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## logistic regression with an improper uniform prior</span></span></span>
<span class="r-in"><span>    <span class="co">## X and y are passed as args to MCMCmetrop1R</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">logitfun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">beta</span>, <span class="va">y</span>, <span class="va">X</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">eta</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta</span></span></span>
<span class="r-in"><span>      <span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1.0</span><span class="op">/</span><span class="op">(</span><span class="fl">1.0</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span> <span class="va">y</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">Xdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">.5</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">.5</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">yvector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">post.samp</span> <span class="op">&lt;-</span> <span class="fu">MCMCmetrop1R</span><span class="op">(</span><span class="va">logitfun</span>, theta.init<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              X<span class="op">=</span><span class="va">Xdata</span>, y<span class="op">=</span><span class="va">yvector</span>,</span></span>
<span class="r-in"><span>                              thin<span class="op">=</span><span class="fl">1</span>, mcmc<span class="op">=</span><span class="fl">40000</span>, burnin<span class="op">=</span><span class="fl">500</span>,</span></span>
<span class="r-in"><span>                              tune<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              verbose<span class="op">=</span><span class="fl">500</span>, logfun<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/coda/man/raftery.diag.html" class="external-link">raftery.diag</a></span><span class="op">(</span><span class="va">post.samp</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">post.samp</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">post.samp</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">## ##################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">##  negative binomial regression with an improper unform prior</span></span></span>
<span class="r-in"><span>    <span class="co">## X and y are passed as args to MCMCmetrop1R</span></span></span>
<span class="r-in"><span>    <span class="va">negbinfun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">y</span>, <span class="va">X</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">beta</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">k</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>      <span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="va">log.like</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                      <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">lgamma</a></span><span class="op">(</span><span class="va">y</span><span class="op">+</span><span class="va">alpha</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">lfactorial</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">lgamma</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                      <span class="va">alpha</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">/</span><span class="op">(</span><span class="va">alpha</span><span class="op">+</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                      <span class="va">y</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">mu</span><span class="op">/</span><span class="op">(</span><span class="va">alpha</span><span class="op">+</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                     <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span>    <span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">XX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">+</span><span class="va">x1</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">n</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">yy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mu</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">post.samp</span> <span class="op">&lt;-</span> <span class="fu">MCMCmetrop1R</span><span class="op">(</span><span class="va">negbinfun</span>, theta.init<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, y<span class="op">=</span><span class="va">yy</span>, X<span class="op">=</span><span class="va">XX</span>,</span></span>
<span class="r-in"><span>                              thin<span class="op">=</span><span class="fl">1</span>, mcmc<span class="op">=</span><span class="fl">35000</span>, burnin<span class="op">=</span><span class="fl">1000</span>,</span></span>
<span class="r-in"><span>                              tune<span class="op">=</span><span class="fl">1.5</span>, verbose<span class="op">=</span><span class="fl">500</span>, logfun<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                              seed<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/coda/man/raftery.diag.html" class="external-link">raftery.diag</a></span><span class="op">(</span><span class="va">post.samp</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">post.samp</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">post.samp</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">## ##################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="co">## sample from a univariate normal distribution with</span></span></span>
<span class="r-in"><span>    <span class="co">## mean 5 and standard deviation 0.1</span></span></span>
<span class="r-in"><span>    <span class="co">##</span></span></span>
<span class="r-in"><span>    <span class="co">## (MCMC obviously not necessary here and this should</span></span></span>
<span class="r-in"><span>    <span class="co">##  really be done with the logdensity for better</span></span></span>
<span class="r-in"><span>    <span class="co">##  numerical accuracy-- this is just an illustration of how</span></span></span>
<span class="r-in"><span>    <span class="co">##  MCMCmetrop1R works with a density rather than logdensity)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="va">post.samp</span> <span class="op">&lt;-</span> <span class="fu">MCMCmetrop1R</span><span class="op">(</span><span class="va">dnorm</span>, theta.init<span class="op">=</span><span class="fl">5.3</span>, mean<span class="op">=</span><span class="fl">5</span>, sd<span class="op">=</span><span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                          thin<span class="op">=</span><span class="fl">1</span>, mcmc<span class="op">=</span><span class="fl">50000</span>, burnin<span class="op">=</span><span class="fl">500</span>,</span></span>
<span class="r-in"><span>                          tune<span class="op">=</span><span class="fl">2.0</span>, verbose<span class="op">=</span><span class="fl">5000</span>, logfun<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">post.samp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Website designed by Jianing Yao</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

