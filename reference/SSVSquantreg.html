<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function uses stochastic search to select promising regression models
at a fixed quantile \(\tau\).  Indicator variables
\(\gamma\) are used to represent whether a predictor is included in
the model or not.  The user supplies the data and the prior distribution on
the model size.  A list is returned containing the posterior sample of
\(\gamma\) and the associated regression parameters
\(\beta\)."><title>Stochastic search variable selection for quantile regression — SSVSquantreg • MCMCpack</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Mono-0.4.8/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Stochastic search variable selection for quantile regression — SSVSquantreg"><meta property="og:description" content="This function uses stochastic search to select promising regression models
at a fixed quantile \(\tau\).  Indicator variables
\(\gamma\) are used to represent whether a predictor is included in
the model or not.  The user supplies the data and the prior distribution on
the model size.  A list is returned containing the posterior sample of
\(\gamma\) and the associated regression parameters
\(\beta\)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MCMCpack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6-3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Demonstration.html">Demonstration</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/JNinnnngg" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Stochastic search variable selection for quantile regression</h1>
      
      <div class="d-none name"><code>SSVSquantreg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function uses stochastic search to select promising regression models
at a fixed quantile \(\tau\).  Indicator variables
\(\gamma\) are used to represent whether a predictor is included in
the model or not.  The user supplies the data and the prior distribution on
the model size.  A list is returned containing the posterior sample of
\(\gamma\) and the associated regression parameters
\(\beta\).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SSVSquantreg</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  include <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  burnin <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  mcmc <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1e+06</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  pi0a0 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pi0b0 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>Model formula.</p></dd>


<dt>data</dt>
<dd><p>Data frame.</p></dd>


<dt>tau</dt>
<dd><p>The quantile of interest. Must be between 0 and 1. The default
value of 0.5 corresponds to median regression model selection.</p></dd>


<dt>include</dt>
<dd><p>The predictor(s) that should definitely appear in the model.
Can be specified by name, or their position in the formula (taking into
account the intercept).</p></dd>


<dt>burnin</dt>
<dd><p>The number of burn-in iterations for the sampler.</p></dd>


<dt>mcmc</dt>
<dd><p>The number of MCMC iterations after burnin.</p></dd>


<dt>thin</dt>
<dd><p>The thinning interval used in the simulation.  The number of
MCMC iterations must be divisible by this value.</p></dd>


<dt>verbose</dt>
<dd><p>A switch which determines whether or not the progress of the
sampler is printed to the screen.  If <code>verbose</code> is greater than 0 the
iteration number, the most recently sampled values of \(\gamma\)
and the associated values of \(\beta\) are printed to the screen
every <code>verbose</code>th iteration.</p></dd>


<dt>seed</dt>
<dd><p>The seed for the random number generator. If NA, the Mersenne
Twister generator is used with default seed 12345; if an integer is passed
it is used to seed the Mersenne twister. The default value for this argument
is a random integer between 1 and 1,000,000.  This default value ensures
that if the function is used again with a different value of
\(\tau\), it is extremely unlikely that the seed will be identical.
The user can also pass a list of length two to use the L'Ecuyer random
number generator, which is suitable for parallel computation.  The first
element of the list is the L'Ecuyer seed, which is a vector of length six or
NA (if NA a default seed of <code>rep(12345,6)</code> is used).  The second
element of list is a positive substream number. See the MCMCpack
specification for more details.</p></dd>


<dt>pi0a0, pi0b0</dt>
<dd><p>Hyperparameters of the beta prior on \(\pi_0\),
the prior probability of including a predictor. Default values of (1,1) are
equivalent to a uniform distribution.</p></dd>


<dt>...</dt>
<dd><p>Further arguments</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list containing:</p>
<dl><dt>gamma</dt>
<dd><p>The posterior sample of \(\gamma\). This has
associated summary and plot methods.</p></dd>


<dt>beta</dt>
<dd><p>The posterior sample of the associated regression parameters
\(\beta\). This can be analysed with functions from the coda
package.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>SSVSquantreg</code> implements stochastic search variable selection
over a set of potential predictors to obtain promising models.  The
models considered take the following form:</p>
<p>$$Q_{\tau}(y_i|x_{i\gamma}) = x_{i\gamma} ' \beta_{\gamma},$$</p>
<p>where \(Q_{\tau}(y_i|x_{i\gamma})\) denotes the conditional
\(\tau\)th quantile of \(y_i\) given \(x_{i\gamma}\),
\(x_{i\gamma}\) denotes \(x_i\) with those predictors
\(x_{ij}\) for which \(\gamma_j=0\) removed and
\(\beta_{\gamma}\) denotes the model specific regression
parameters.</p>
<p>The likelihood is formed based on the assumption of independent
asymmetric Laplace distributions on the \(y_i\) with skewness
parameter \(\tau\) and location parameters \( x_{i\gamma} '
\beta_{\gamma}\). This assumption ensures that the likelihood
function is maximised by the \(\tau\)th conditional quantile of
the response variable.</p>
<p>The prior on each \(\beta_j\) is</p>
<p>$$(1-\gamma_j)\delta_0+\gamma_j\mbox{Cauchy}(0,1),$$</p>
<p>where \(\delta_0\) denotes a degenerate distribution with all
mass at 0.  A standard Cauchy distribution is chosen conditional on
\(\gamma_j=1\).  This allows for a wider range of nonzero
values of \(\beta_j\) than a standard Normal distribution,
improving the robustness of the method.  Each of the indicator variables
\(\gamma_j\) is independently assigned a Bernoulli prior, with
prior probability of inclusion \(\pi_0\).  This in turn is assigned
a beta distribution, resulting in a beta-binomial prior on the model size.
The user can supply the hyperparameters for the beta distribution.  Starting
values are randomly generated from the prior distribution.</p>
<p>It is recommended to standardise any non-binary predictors in order to
compare these predictors on the same scale.  This can be achieved using the
<code>scale</code> function.</p>
<p>If it is certain that a predictor should be included, all predictors
specified are brought to the first positions for computational convenience.
The regression parameters associated with these predictors are given
independent improper priors. Users may notice a small speed advantage if
they specify the predictors that they feel certain should appear in the
model, particularly for large models with a large number of observations.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Craig Reed, David B. Dunson and Keming Yu. 2010. "Bayesian
Variable Selection for Quantile Regression" Technical Report.</p>
<p>Daniel Pemstein, Kevin M. Quinn, and Andrew D. Martin.  2007.  <em>Scythe
Statistical Library 1.2.</em> <a href="http://scythe.lsa.umich.edu" class="external-link">http://scythe.lsa.umich.edu</a>.</p>
<p>Keming Yu and Jin Zhang. 2005. "A Three Parameter Asymmetric Laplace
Distribution and it's extensions." <em>Communications in Statistics -
Theory and Methods</em>, 34, 1867-1879.</p>
<p>Martyn Plummer, Nicky Best, Kate Cowles, and Karen Vines. 2006.  ``Output
Analysis and Diagnostics for MCMC (CODA)'', <em>R News</em>. 6(1): 7-11.
<a href="https://CRAN.R-project.org/doc/Rnews/Rnews_2006-1.pdf" class="external-link">https://CRAN.R-project.org/doc/Rnews/Rnews_2006-1.pdf</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="MCMCquantreg.html">MCMCquantreg</a></code>,
<code><a href="summaryqrssvs.html">summary.qrssvs</a></code>, <code><a href="plot.qrssvs.html">plot.qrssvs</a></code>,
<code><a href="mptable.html">mptable</a></code>, <code><a href="topmodels.html">topmodels</a></code>,
<code><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></code>, <code><a href="https://rdrr.io/pkg/quantreg/man/rq.html" class="external-link">rq</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Craig Reed</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">epsilon</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>,<span class="fl">100</span>,<span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">&lt;-</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">x</span><span class="op">[</span>,<span class="fl">10</span><span class="op">]</span><span class="op">+</span><span class="va">epsilon</span></span></span>
<span class="r-in"><span><span class="va">qrssvs</span><span class="op">&lt;-</span><span class="fu">SSVSquantreg</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model.50pc</span><span class="op">&lt;-</span><span class="fu">SSVSquantreg</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model.90pc</span><span class="op">&lt;-</span><span class="fu">SSVSquantreg</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>,tau<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model.50pc</span><span class="op">)</span> <span class="co">## Intercept not in median probability model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model.90pc</span><span class="op">)</span> <span class="co">## Intercept appears in median probability model</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Website designed by Jianing Yao</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

