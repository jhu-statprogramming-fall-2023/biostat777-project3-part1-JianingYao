<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function generates a sample from the posterior distribution of a
multinomial logistic regression model using either a random walk Metropolis
algorithm or a slice sampler. The user supplies data and priors, and a
sample from the posterior distribution is returned as an mcmc object, which
can be subsequently analyzed with functions provided in the coda package."><title>Markov Chain Monte Carlo for Multinomial Logistic Regression — MCMCmnl • MCMCpack</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Mono-0.4.7/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Markov Chain Monte Carlo for Multinomial Logistic Regression — MCMCmnl"><meta property="og:description" content="This function generates a sample from the posterior distribution of a
multinomial logistic regression model using either a random walk Metropolis
algorithm or a slice sampler. The user supplies data and priors, and a
sample from the posterior distribution is returned as an mcmc object, which
can be subsequently analyzed with functions provided in the coda package."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MCMCpack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6-3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Demonstration.html">Demonstration</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/JNinnnngg" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Markov Chain Monte Carlo for Multinomial Logistic Regression</h1>
      
      <div class="d-none name"><code>MCMCmnl.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates a sample from the posterior distribution of a
multinomial logistic regression model using either a random walk Metropolis
algorithm or a slice sampler. The user supplies data and priors, and a
sample from the posterior distribution is returned as an mcmc object, which
can be subsequently analyzed with functions provided in the coda package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MCMCmnl</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  baseline <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  burnin <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  mcmc <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mcmc.method <span class="op">=</span> <span class="st">"IndMH"</span>,</span>
<span>  tune <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  tdf <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  beta.start <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  b0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  B0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>Model formula.</p>
<p>If the choicesets do not vary across individuals, the <code>y</code> variable
should be a factor or numeric variable that gives the observed choice of
each individual. If the choicesets do vary across individuals, <code>y</code>
should be a \(n \times p\) matrix where \(n\) is the number of
individuals and \(p\) is the maximum number of choices in any
choiceset.  Here each column of <code>y</code> corresponds to a particular
observed choice and the elements of <code>y</code> should be either <code>0</code> (not
chosen but available), <code>1</code> (chosen), or <code>-999</code> (not available).</p>
<p>Choice-specific covariates have to be entered using the syntax:
<code>choicevar(cvar, "var", "choice")</code> where <code>cvar</code> is the name of a
variable in <code>data</code>, <code>"var"</code> is the name of the new variable to be
created, and <code>"choice"</code> is the level of <code>y</code> that <code>cvar</code>
corresponds to. Specifying each choice-specific covariate will typically
require \(p\) calls to the <code>choicevar</code> function in the formula.</p>
<p>Individual specific covariates can be entered into the formula normally.</p>
<p>See the examples section below to see the syntax used to fit various models.</p></dd>


<dt>baseline</dt>
<dd><p>The baseline category of the response variable.</p>
<p><code>baseline</code> should be set equal to one of the observed levels of the
response variable. If left equal to <code>NULL</code> then the baseline level is
set to the alpha-numerically first element of the response variable. If the
choicesets vary across individuals, the baseline choice must be in the
choiceset of each individual.</p></dd>


<dt>data</dt>
<dd><p>The data frame used for the analysis. Each row of the dataframe
should correspond to an individual who is making a choice.</p></dd>


<dt>burnin</dt>
<dd><p>The number of burn-in iterations for the sampler.</p></dd>


<dt>mcmc</dt>
<dd><p>The number of iterations to run the sampler past burn-in.</p></dd>


<dt>thin</dt>
<dd><p>The thinning interval used in the simulation.  The number of
mcmc iterations must be divisible by this value.</p></dd>


<dt>mcmc.method</dt>
<dd><p>Can be set to either "IndMH" (default), "RWM", or "slice"
to perform independent Metropolis-Hastings sampling, random walk Metropolis
sampling or slice sampling respectively.</p></dd>


<dt>tune</dt>
<dd><p>Metropolis tuning parameter. Can be either a positive scalar or
a \(k\)-vector, where \(k\) is the length of \(\beta\).
Make sure that the acceptance rate is satisfactory (typically between 0.20
and 0.5) before using the posterior sample for inference.</p></dd>


<dt>tdf</dt>
<dd><p>Degrees of freedom for the multivariate-t proposal distribution
when <code>mcmc.method</code> is set to "IndMH". Must be positive.</p></dd>


<dt>verbose</dt>
<dd><p>A switch which determines whether or not the progress of the
sampler is printed to the screen.  If <code>verbose</code> is greater than 0 the
iteration number, the current beta vector, and the Metropolis acceptance
rate are printed to the screen every <code>verbose</code>th iteration.</p></dd>


<dt>seed</dt>
<dd><p>The seed for the random number generator.  If NA, the Mersenne
Twister generator is used with default seed 12345; if an integer is passed
it is used to seed the Mersenne twister.  The user can also pass a list of
length two to use the L'Ecuyer random number generator, which is suitable
for parallel computation.  The first element of the list is the L'Ecuyer
seed, which is a vector of length six or NA (if NA a default seed of
<code>rep(12345,6)</code> is used).  The second element of list is a positive
substream number. See the MCMCpack specification for more details.</p></dd>


<dt>beta.start</dt>
<dd><p>The starting value for the \(\beta\) vector.  This
can either be a scalar or a column vector with dimension equal to the number
of betas. If this takes a scalar value, then that value will serve as the
starting value for all of the betas.  The default value of NA will use the
maximum likelihood estimate of \(\beta\) as the starting value.</p></dd>


<dt>b0</dt>
<dd><p>The prior mean of \(\beta\).  This can either be a scalar
or a column vector with dimension equal to the number of betas. If this
takes a scalar value, then that value will serve as the prior mean for all
of the betas.</p></dd>


<dt>B0</dt>
<dd><p>The prior precision of \(\beta\). This can either be a
scalar or a square matrix with dimensions equal to the number of betas.  If
this takes a scalar value, then that value times an identity matrix serves
as the prior precision of \(\beta\). Default value of 0 is
equivalent to an improper uniform prior for beta.</p></dd>


<dt>...</dt>
<dd><p>Further arguments to be passed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An mcmc object that contains the posterior sample.  This object can
be summarized by functions provided by the coda package.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>MCMCmnl</code> simulates from the posterior distribution of a multinomial
logistic regression model using either a random walk Metropolis algorithm or
a univariate slice sampler. The simulation proper is done in compiled C++
code to maximize efficiency.  Please consult the coda documentation for a
comprehensive list of functions that can be used to analyze the posterior
sample.</p>
<p>The model takes the following form:</p>
<p>$$y_i \sim \mathcal{M}ultinomial(\pi_i)$$</p>
<p>where:</p>
<p>$$\pi_{ij} = \frac{\exp(x_{ij}'\beta)}{\sum_{k=1}^p\exp(x_{ik}'\beta)}$$</p>
<p>We assume a multivariate Normal prior on \(\beta\):</p>
<p>$$\beta \sim \mathcal{N}(b_0,B_0^{-1})$$</p>
<p>The Metropolis proposal distribution is centered at the current
value of \(\beta\) and has variance-covariance
\(V = T(B_0 + C^{-1})^{-1} T\), where \(T\) is a the
diagonal positive definite matrix formed from the <code>tune</code>,
\(B_0\) is the prior precision, and \(C\) is the large sample
variance-covariance matrix of the MLEs. This last calculation is
done via an initial call to <code>optim</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Andrew D. Martin, Kevin M. Quinn, and Jong Hee Park. 2011.  ``MCMCpack:
Markov Chain Monte Carlo in R.'', <em>Journal of Statistical Software</em>.
42(9): 1-21.  <a href="https://doi.org/10.18637/jss.v042.i09" class="external-link">doi:10.18637/jss.v042.i09</a>
.</p>
<p>Daniel Pemstein, Kevin M. Quinn, and Andrew D. Martin.  2007.  <em>Scythe
Statistical Library 1.0.</em> <a href="http://scythe.lsa.umich.edu" class="external-link">http://scythe.lsa.umich.edu</a>.</p>
<p>Radford Neal. 2003. ``Slice Sampling'' (with discussion). <em>Annals of
Statistics</em>, 31: 705-767.</p>
<p>Martyn Plummer, Nicky Best, Kate Cowles, and Karen Vines. 2006.  ``Output
Analysis and Diagnostics for MCMC (CODA)'', <em>R News</em>. 6(1): 7-11.
<a href="https://CRAN.R-project.org/doc/Rnews/Rnews_2006-1.pdf" class="external-link">https://CRAN.R-project.org/doc/Rnews/Rnews_2006-1.pdf</a>.</p>
<p>Siddhartha Chib, Edward Greenberg, and Yuxin Chen. 1998.  ``MCMC Methods for
Fitting and Comparing Multinomial Response Models."</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/coda/man/plot.mcmc.html" class="external-link">plot.mcmc</a></code>,<code><a href="https://rdrr.io/pkg/coda/man/summary.mcmc.html" class="external-link">summary.mcmc</a></code>,
<code><a href="https://rdrr.io/pkg/nnet/man/multinom.html" class="external-link">multinom</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Nethvote</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## just a choice-specific X var</span></span></span>
<span class="r-in"><span>  <span class="va">post1</span> <span class="op">&lt;-</span> <span class="fu">MCMCmnl</span><span class="op">(</span><span class="va">vote</span> <span class="op">~</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">distD66</span>, <span class="st">"sqdist"</span>, <span class="st">"D66"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">distPvdA</span>, <span class="st">"sqdist"</span>, <span class="st">"PvdA"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">distVVD</span>, <span class="st">"sqdist"</span>, <span class="st">"VVD"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">distCDA</span>, <span class="st">"sqdist"</span>, <span class="st">"CDA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                baseline<span class="op">=</span><span class="st">"D66"</span>, mcmc.method<span class="op">=</span><span class="st">"IndMH"</span>, B0<span class="op">=</span><span class="fl">0</span>,</span></span>
<span class="r-in"><span>                verbose<span class="op">=</span><span class="fl">500</span>, mcmc<span class="op">=</span><span class="fl">100000</span>, thin<span class="op">=</span><span class="fl">10</span>, tune<span class="op">=</span><span class="fl">1.0</span>,</span></span>
<span class="r-in"><span>                data<span class="op">=</span><span class="va">Nethvote</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">post1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">post1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## just individual-specific X vars</span></span></span>
<span class="r-in"><span>  <span class="va">post2</span><span class="op">&lt;-</span> <span class="fu">MCMCmnl</span><span class="op">(</span><span class="va">vote</span> <span class="op">~</span></span></span>
<span class="r-in"><span>                <span class="va">relig</span> <span class="op">+</span> <span class="va">class</span> <span class="op">+</span> <span class="va">income</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">urban</span>,</span></span>
<span class="r-in"><span>                baseline<span class="op">=</span><span class="st">"D66"</span>, mcmc.method<span class="op">=</span><span class="st">"IndMH"</span>, B0<span class="op">=</span><span class="fl">0</span>,</span></span>
<span class="r-in"><span>                verbose<span class="op">=</span><span class="fl">500</span>, mcmc<span class="op">=</span><span class="fl">100000</span>, thin<span class="op">=</span><span class="fl">10</span>, tune<span class="op">=</span><span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                data<span class="op">=</span><span class="va">Nethvote</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">post2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">post2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## both choice-specific and individual-specific X vars</span></span></span>
<span class="r-in"><span>  <span class="va">post3</span> <span class="op">&lt;-</span> <span class="fu">MCMCmnl</span><span class="op">(</span><span class="va">vote</span> <span class="op">~</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">distD66</span>, <span class="st">"sqdist"</span>, <span class="st">"D66"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">distPvdA</span>, <span class="st">"sqdist"</span>, <span class="st">"PvdA"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">distVVD</span>, <span class="st">"sqdist"</span>, <span class="st">"VVD"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">distCDA</span>, <span class="st">"sqdist"</span>, <span class="st">"CDA"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                <span class="va">relig</span> <span class="op">+</span> <span class="va">class</span> <span class="op">+</span> <span class="va">income</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">urban</span>,</span></span>
<span class="r-in"><span>                baseline<span class="op">=</span><span class="st">"D66"</span>, mcmc.method<span class="op">=</span><span class="st">"IndMH"</span>, B0<span class="op">=</span><span class="fl">0</span>,</span></span>
<span class="r-in"><span>                verbose<span class="op">=</span><span class="fl">500</span>, mcmc<span class="op">=</span><span class="fl">100000</span>, thin<span class="op">=</span><span class="fl">10</span>, tune<span class="op">=</span><span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                data<span class="op">=</span><span class="va">Nethvote</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">post3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">post3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## numeric y variable</span></span></span>
<span class="r-in"><span>  <span class="va">nethvote</span><span class="op">$</span><span class="va">vote</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">nethvote</span><span class="op">$</span><span class="va">vote</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">post4</span> <span class="op">&lt;-</span> <span class="fu">MCMCmnl</span><span class="op">(</span><span class="va">vote</span> <span class="op">~</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">distD66</span>, <span class="st">"sqdist"</span>, <span class="st">"2"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">distPvdA</span>, <span class="st">"sqdist"</span>, <span class="st">"3"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">distVVD</span>, <span class="st">"sqdist"</span>, <span class="st">"4"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                <span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">distCDA</span>, <span class="st">"sqdist"</span>, <span class="st">"1"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                <span class="va">relig</span> <span class="op">+</span> <span class="va">class</span> <span class="op">+</span> <span class="va">income</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">urban</span>,</span></span>
<span class="r-in"><span>                baseline<span class="op">=</span><span class="st">"2"</span>, mcmc.method<span class="op">=</span><span class="st">"IndMH"</span>, B0<span class="op">=</span><span class="fl">0</span>,</span></span>
<span class="r-in"><span>                verbose<span class="op">=</span><span class="fl">500</span>, mcmc<span class="op">=</span><span class="fl">100000</span>, thin<span class="op">=</span><span class="fl">10</span>, tune<span class="op">=</span><span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                data<span class="op">=</span><span class="va">Nethvote</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">post4</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">post4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## Simulated data example with nonconstant choiceset</span></span></span>
<span class="r-in"><span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">xa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">xb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">xc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">xd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">xchoice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">xa</span>, <span class="va">xb</span>, <span class="va">xc</span>, <span class="va">xd</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co">## randomly determine choiceset (c is always in choiceset)</span></span></span>
<span class="r-in"><span>    <span class="va">choiceset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fl">2</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">numer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">choiceset</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="kw">if</span> <span class="op">(</span><span class="va">j</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">numer</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">xchoice</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="op">}</span></span></span>
<span class="r-in"><span>      <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">numer</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">xchoice</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span> <span class="op">-</span> <span class="va">z</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">numer</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">numer</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">y</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">rmultinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">y</span><span class="op">[</span><span class="va">i</span>,<span class="op">-</span><span class="va">choiceset</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">999</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">post5</span> <span class="op">&lt;-</span> <span class="fu">MCMCmnl</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">xa</span>, <span class="st">"x"</span>, <span class="st">"a"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                  <span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">xb</span>, <span class="st">"x"</span>, <span class="st">"b"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                  <span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">xc</span>, <span class="st">"x"</span>, <span class="st">"c"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                  <span class="fu"><a href="choicevar.html">choicevar</a></span><span class="op">(</span><span class="va">xd</span>, <span class="st">"x"</span>, <span class="st">"d"</span><span class="op">)</span> <span class="op">+</span> <span class="va">z</span>,</span></span>
<span class="r-in"><span>                  baseline<span class="op">=</span><span class="st">"c"</span>, verbose<span class="op">=</span><span class="fl">500</span>,</span></span>
<span class="r-in"><span>                  mcmc<span class="op">=</span><span class="fl">100000</span>, thin<span class="op">=</span><span class="fl">10</span>, tune<span class="op">=</span><span class="fl">.85</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">post5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">post5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Website designed by Jianing Yao</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

